<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chinh Ph·ª•c ƒê·ªânh Cao ƒêa Th·ª©c - Pro Version</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Quicksand', sans-serif;
            background: linear-gradient(135deg, #1a2a6c, #b21f1f, #fdbb2d);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0;
            overflow-x: hidden;
        }
        .glass-card {
            background: rgba(255, 255, 255, 0.98);
            backdrop-filter: blur(15px);
            border-radius: 2rem;
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5);
        }
        .option-btn {
            transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
            border: 2px solid #edf2f7;
            position: relative;
            overflow: hidden;
        }
        .option-btn:hover:not(:disabled) {
            transform: scale(1.01);
            border-color: #4f46e5;
        }
        .option-btn:disabled {
            cursor: default;
            opacity: 0.8;
        }
        .option-btn.correct {
            background-color: #10b981 !important;
            color: white !important;
            border-color: #059669 !important;
            opacity: 1 !important;
        }
        .option-btn.wrong {
            background-color: #ef4444 !important;
            color: white !important;
            border-color: #dc2626 !important;
            animation: shake 0.4s ease-in-out;
            opacity: 1 !important;
        }
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-8px); }
            75% { transform: translateX(8px); }
        }
        .timer-low {
            color: #ef4444;
            animation: pulse 1s infinite;
        }
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }
        .explanation-box {
            animation: slideUp 0.4s ease-out;
        }
        @keyframes slideUp {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
    </style>
</head>
<body>

    <div id="game-container" class="w-full max-w-2xl p-4">
        <!-- Start Screen -->
        <div id="start-screen" class="glass-card p-10 text-center">
            <h1 class="text-5xl font-extrabold text-transparent bg-clip-text bg-gradient-to-r from-indigo-600 to-purple-600 mb-4 uppercase">Math Master</h1>
            <h2 class="text-2xl font-bold text-gray-700 mb-6">Chinh Ph·ª•c ƒêa Th·ª©c M·ªôt Bi·∫øn</h2>
            
            <div class="grid grid-cols-2 gap-4 mb-8 text-left">
                <div class="bg-blue-50 p-4 rounded-xl">
                    <p class="text-xs text-blue-600 font-bold uppercase tracking-wider">S·ªë c√¢u h·ªèi</p>
                    <p class="text-gray-700 font-semibold">15 c√¢u ph√¢n c·∫•p</p>
                </div>
                <div class="bg-orange-50 p-4 rounded-xl">
                    <p class="text-xs text-orange-600 font-bold uppercase tracking-wider">Th·ªùi gian</p>
                    <p class="text-gray-700 font-semibold">10 ph√∫t t·ªïng c·ªông</p>
                </div>
                <div class="bg-green-50 p-4 rounded-xl">
                    <p class="text-xs text-green-600 font-bold uppercase tracking-wider">Th∆∞·ªüng t·ªëc ƒë·ªô</p>
                    <p class="text-gray-700 font-semibold">ƒê√∫ng < 10 gi√¢y</p>
                </div>
                <div class="bg-purple-50 p-4 rounded-xl">
                    <p class="text-xs text-purple-600 font-bold uppercase tracking-wider">H·ªá th·ªëng</p>
                    <p class="text-gray-700 font-semibold">C√≥ l·ªùi gi·∫£i chi ti·∫øt</p>
                </div>
            </div>

            <button onclick="startGame()" class="w-full bg-gradient-to-r from-indigo-600 to-blue-600 hover:from-indigo-700 hover:to-blue-700 text-white font-bold py-4 px-10 rounded-2xl text-2xl shadow-2xl transition transform hover:-translate-y-1">
                B·∫ÆT ƒê·∫¶U CH∆†I
            </button>
        </div>

        <!-- Quiz Screen -->
        <div id="quiz-screen" class="glass-card p-8 hidden">
            <div class="flex justify-between items-center mb-4">
                <div class="flex flex-col">
                    <span class="text-[10px] font-bold text-gray-400 uppercase">Ti·∫øn tr√¨nh</span>
                    <span class="text-lg font-bold text-indigo-600" id="question-counter">01/15</span>
                </div>
                <div class="flex flex-col items-center">
                    <span class="text-[10px] font-bold text-gray-400 uppercase">Th·ªùi gian</span>
                    <span class="text-2xl font-black text-gray-800" id="game-timer">10:00</span>
                </div>
                <div class="flex flex-col items-end">
                    <span class="text-[10px] font-bold text-gray-400 uppercase">ƒêi·ªÉm</span>
                    <span class="text-lg font-bold text-orange-500" id="score-display">0</span>
                </div>
            </div>
            
            <div class="w-full bg-gray-100 rounded-full h-2 mb-6 overflow-hidden">
                <div id="progress-bar" class="bg-gradient-to-r from-indigo-500 to-purple-500 h-full transition-all duration-500" style="width: 0%"></div>
            </div>

            <div id="question-area">
                <div id="question-text" class="text-xl md:text-2xl font-bold text-gray-800 mb-6 leading-tight"></div>
                <div id="options-container" class="grid grid-cols-1 gap-3"></div>
            </div>

            <!-- Explanation Section (Visible after answering) -->
            <div id="explanation-box" class="explanation-box mt-6 p-5 bg-indigo-50 border-2 border-indigo-100 rounded-2xl hidden">
                <div class="flex items-start gap-3">
                    <div class="bg-indigo-600 text-white rounded-full p-1 mt-1 flex-shrink-0">
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                    </div>
                    <div>
                        <p class="font-bold text-indigo-900 mb-1">Gi·∫£i th√≠ch:</p>
                        <p id="explanation-text" class="text-indigo-800 text-sm leading-relaxed italic"></p>
                    </div>
                </div>
                <button onclick="nextQuestion()" class="mt-5 w-full bg-indigo-600 text-white font-bold py-3 rounded-xl hover:bg-indigo-700 shadow-lg shadow-indigo-200 transition">TI·∫æP T·ª§C ‚Üí</button>
            </div>
        </div>

        <!-- Result Screen -->
        <div id="result-screen" class="glass-card p-10 text-center hidden">
            <div id="result-icon" class="mb-4"></div>
            <h2 class="text-3xl font-black text-gray-800 mb-1" id="result-title">K·∫æT QU·∫¢</h2>
            <p id="final-status" class="text-md text-gray-500 mb-8 px-4"></p>
            
            <div class="grid grid-cols-3 gap-3 mb-10">
                <div class="p-3 bg-indigo-50 rounded-2xl">
                    <p class="text-[10px] font-bold text-indigo-400 uppercase">ƒêi·ªÉm c∆° b·∫£n</p>
                    <p id="final-score" class="text-2xl font-black text-indigo-700">0</p>
                </div>
                <div class="p-3 bg-orange-50 rounded-2xl">
                    <p class="text-[10px] font-bold text-orange-400 uppercase">Th∆∞·ªüng t·ªëc ƒë·ªô</p>
                    <p id="final-bonus" class="text-2xl font-black text-orange-600">0</p>
                </div>
                <div class="p-3 bg-green-50 rounded-2xl">
                    <p class="text-[10px] font-bold text-green-400 uppercase">ƒê·ªô ch√≠nh x√°c</p>
                    <p id="final-accuracy" class="text-2xl font-black text-green-600">0%</p>
                </div>
            </div>

            <button onclick="restartGame()" class="bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-4 px-12 rounded-2xl shadow-xl transition transform hover:scale-105">
                CH∆†I L·∫†I
            </button>
        </div>
    </div>

    <script>
        const questions = [
            {
                q: "C√¢u 1: Bi·ªÉu th·ª©c n√†o sau ƒë√¢y l√† ƒëa th·ª©c m·ªôt bi·∫øn x?",
                options: ["2x + 3y", "x¬≤ - 5x + 1", "1/x + 2", "x + ‚àöx"],
                correct: 1,
                exp: "ƒêa th·ª©c m·ªôt bi·∫øn ch·ªâ ch·ª©a m·ªôt ch·ªØ c√°i (bi·∫øn) v√† c√°c l≈©y th·ª´a c·ªßa bi·∫øn ph·∫£i l√† s·ªë t·ª± nhi√™n. '2x + 3y' c√≥ 2 bi·∫øn, '1/x' v√† '‚àöx' kh√¥ng ph·∫£i l≈©y th·ª´a t·ª± nhi√™n."
            },
            {
                q: "C√¢u 2: B·∫≠c c·ªßa ƒëa th·ª©c f(x) = 7x¬≥ - 5x + 2 l√† bao nhi√™u?",
                options: ["1", "2", "3", "7"],
                correct: 2,
                exp: "B·∫≠c c·ªßa ƒëa th·ª©c m·ªôt bi·∫øn l√† s·ªë m≈© l·ªõn nh·∫•t c·ªßa bi·∫øn trong ƒëa th·ª©c ƒë√≥. ·ªû ƒë√¢y s·ªë m≈© l·ªõn nh·∫•t l√† 3 (trong h·∫°ng t·ª≠ 7x¬≥)."
            },
            {
                q: "C√¢u 3: H·ªá s·ªë cao nh·∫•t c·ªßa ƒëa th·ª©c P(x) = 2x - 5x¬≤ + 1 l√†:",
                options: ["2", "-5", "1", "0"],
                correct: 1,
                exp: "H·ªá s·ªë cao nh·∫•t l√† h·ªá s·ªë c·ªßa h·∫°ng t·ª≠ c√≥ b·∫≠c cao nh·∫•t. B·∫≠c cao nh·∫•t l√† 2 (h·∫°ng t·ª≠ -5x¬≤), v·∫≠y h·ªá s·ªë cao nh·∫•t l√† -5."
            },
            {
                q: "C√¢u 4: H·ªá s·ªë t·ª± do c·ªßa ƒëa th·ª©c Q(x) = x‚Å¥ - 3x¬≤ - 8 l√†:",
                options: ["1", "-3", "8", "-8"],
                correct: 3,
                exp: "H·ªá s·ªë t·ª± do l√† h·∫°ng t·ª≠ kh√¥ng ch·ª©a bi·∫øn x. Trong Q(x), ƒë√≥ ch√≠nh l√† s·ªë -8."
            },
            {
                q: "C√¢u 5: Trong c√°c s·ªë sau, s·ªë n√†o l√† nghi·ªám c·ªßa ƒëa th·ª©c P(x) = x - 5?",
                options: ["x = 0", "x = -5", "x = 5", "x = 1"],
                correct: 2,
                exp: "Nghi·ªám c·ªßa ƒëa th·ª©c l√† gi√° tr·ªã l√†m cho ƒëa th·ª©c b·∫±ng 0. Thay x = 5 v√†o P(x) ta c√≥ 5 - 5 = 0."
            },
            {
                q: "C√¢u 6: R√∫t g·ªçn ƒëa th·ª©c: A(x) = 3x¬≤ - 5x + x¬≤ - 2x + 7",
                options: ["4x¬≤ - 7x + 7", "2x¬≤ - 3x + 7", "4x¬≤ + 7x + 7", "4x‚Å¥ - 7x + 7"],
                correct: 0,
                exp: "Nh√≥m c√°c h·∫°ng t·ª≠ ƒë·ªìng d·∫°ng: (3x¬≤ + x¬≤) + (-5x - 2x) + 7 = 4x¬≤ - 7x + 7."
            },
            {
                q: "C√¢u 7: S·∫Øp x·∫øp ƒëa th·ª©c B(x) = 2x - 3x¬≥ + x¬≤ + 5 theo s·ªë m≈© gi·∫£m d·∫ßn c·ªßa bi·∫øn:",
                options: ["5 + 2x + x¬≤ - 3x¬≥", "-3x¬≥ + x¬≤ + 2x + 5", "x¬≤ + 2x - 3x¬≥ + 5", "-3x¬≥ + 2x + x¬≤ + 5"],
                correct: 1,
                exp: "S·∫Øp x·∫øp theo l≈©y th·ª´a gi·∫£m d·∫ßn: m≈© 3 ‚Üí m≈© 2 ‚Üí m≈© 1 ‚Üí h·ªá s·ªë t·ª± do. K·∫øt qu·∫£ l√† -3x¬≥ + x¬≤ + 2x + 5."
            },
            {
                q: "C√¢u 8: Gi√° tr·ªã c·ªßa ƒëa th·ª©c f(x) = x¬≥ - 2x t·∫°i x = -1 l√†:",
                options: ["-3", "1", "-1", "3"],
                correct: 1,
                exp: "Thay x = -1 v√†o bi·ªÉu th·ª©c: (-1)¬≥ - 2(-1) = -1 + 2 = 1."
            },
            {
                q: "C√¢u 9: B·∫≠c c·ªßa ƒëa th·ª©c sau khi thu g·ªçn: P(x) = x‚Å¥ - 2x¬≤ + 1 - x‚Å¥ l√†:",
                options: ["4", "2", "1", "0"],
                correct: 1,
                exp: "Khi thu g·ªçn, x‚Å¥ tr·ª´ cho x‚Å¥ b·∫±ng 0. ƒêa th·ª©c c√≤n l·∫°i l√† -2x¬≤ + 1, do ƒë√≥ b·∫≠c cao nh·∫•t l√† 2."
            },
            {
                q: "C√¢u 10: R√∫t g·ªçn ƒëa th·ª©c: M(x) = 2x(x - 3) - 2x¬≤ + 5x",
                options: ["-x", "11x", "4x¬≤ - x", "x"],
                correct: 0,
                exp: "Nh√¢n ph√° ngo·∫∑c: 2x¬≤ - 6x - 2x¬≤ + 5x. Thu g·ªçn (2x¬≤ - 2x¬≤) v√† (-6x + 5x), ta ƒë∆∞·ª£c k·∫øt qu·∫£ l√† -x."
            },
            {
                q: "C√¢u 11: T√¨m nghi·ªám c·ªßa ƒëa th·ª©c H(x) = (x - 2)(2x + 6)",
                options: ["x = 2", "x = -3", "x = 2 ho·∫∑c x = -3", "x = 2 ho·∫∑c x = 3"],
                correct: 2,
                exp: "ƒê·ªÉ t√≠ch b·∫±ng 0, m·ªôt trong hai nh√¢n t·ª≠ ph·∫£i b·∫±ng 0. x - 2 = 0 cho x = 2; 2x + 6 = 0 cho x = -3."
            },
            {
                q: "C√¢u 12: ƒêa th·ª©c n√†o d∆∞·ªõi ƒë√¢y KH√îNG c√≥ nghi·ªám th·ª±c?",
                options: ["x¬≤ - 4", "x + 10", "x¬≤ + 1", "x¬≥ + 1"],
                correct: 2,
                exp: "x¬≤ lu√¥n ‚â• 0 v·ªõi m·ªçi x, n√™n x¬≤ + 1 lu√¥n ‚â• 1. Do ƒë√≥ bi·ªÉu th·ª©c n√†y kh√¥ng bao gi·ªù b·∫±ng 0."
            },
            {
                q: "C√¢u 13: Cho ƒëa th·ª©c P(x) = ax + b. Bi·∫øt P(0) = 3 v√† P(1) = 5. T√¨m a v√† b:",
                options: ["a = 2, b = 3", "a = 3, b = 2", "a = 5, b = 3", "a = 2, b = 5"],
                correct: 0,
                exp: "Thay x = 0: a.0 + b = 3 => b = 3. Thay x = 1: a.1 + 3 = 5 => a = 2."
            },
            {
                q: "C√¢u 14: Thu g·ªçn v√† t√¨m b·∫≠c c·ªßa ƒëa th·ª©c: Q(x) = x¬≤(x + 1) - x¬≥ + 5x",
                options: ["B·∫≠c 3", "B·∫≠c 2", "B·∫≠c 1", "B·∫≠c 0"],
                correct: 1,
                exp: "Q(x) = x¬≥ + x¬≤ - x¬≥ + 5x = x¬≤ + 5x. Sau khi tri·ªát ti√™u x¬≥, s·ªë m≈© l·ªõn nh·∫•t l√† 2."
            },
            {
                q: "C√¢u 15: Cho ƒëa th·ª©c f(x) th·ªèa m√£n f(x) + x.f(-x) = x + 1. T√≠nh f(1):",
                options: ["0", "1", "2", "0.5"],
                correct: 1,
                exp: "T·∫°i x=1: f(1)+f(-1)=2. T·∫°i x=-1: f(-1)-f(1)=0 => f(-1)=f(1). Thay l·∫°i: f(1)+f(1)=2 => 2f(1)=2 => f(1)=1."
            }
        ];

        let currentQuestion = 0;
        let score = 0;
        let speedBonus = 0;
        let canAnswer = true;
        let gameTime = 600; // 10 mins
        let timerInterval;
        let questionStartTime;

        const startScreen = document.getElementById('start-screen');
        const quizScreen = document.getElementById('quiz-screen');
        const resultScreen = document.getElementById('result-screen');
        const questionText = document.getElementById('question-text');
        const optionsContainer = document.getElementById('options-container');
        const questionCounter = document.getElementById('question-counter');
        const scoreDisplay = document.getElementById('score-display');
        const progressBar = document.getElementById('progress-bar');
        const explanationBox = document.getElementById('explanation-box');
        const explanationText = document.getElementById('explanation-text');
        const gameTimerDisplay = document.getElementById('game-timer');

        function startGame() {
            startScreen.classList.add('hidden');
            quizScreen.classList.remove('hidden');
            resultScreen.classList.add('hidden');
            currentQuestion = 0;
            score = 0;
            speedBonus = 0;
            gameTime = 600;
            updateScore();
            showQuestion();
            startTimer();
        }

        function startTimer() {
            clearInterval(timerInterval);
            timerInterval = setInterval(() => {
                gameTime--;
                let mins = Math.floor(gameTime / 60);
                let secs = gameTime % 60;
                gameTimerDisplay.innerText = `${mins}:${secs < 10 ? '0' : ''}${secs}`;
                
                if (gameTime <= 60) gameTimerDisplay.classList.add('timer-low');
                if (gameTime <= 0) endGame();
            }, 1000);
        }

        function showQuestion() {
            canAnswer = true;
            explanationBox.classList.add('hidden');
            
            const q = questions[currentQuestion];
            questionCounter.innerText = `${(currentQuestion + 1).toString().padStart(2, '0')}/15`;
            questionText.innerText = q.q;
            
            progressBar.style.width = `${(currentQuestion / questions.length) * 100}%`;

            optionsContainer.innerHTML = '';
            q.options.forEach((option, index) => {
                const btn = document.createElement('button');
                btn.className = 'option-btn w-full p-4 text-left rounded-2xl font-bold bg-white text-gray-700 shadow-sm border-2 border-gray-100';
                btn.innerText = option;
                btn.onclick = () => checkAnswer(index, btn);
                optionsContainer.appendChild(btn);
            });
            questionStartTime = Date.now();
        }

        function checkAnswer(selectedIndex, btn) {
            if (!canAnswer) return;
            canAnswer = false;

            const timeTaken = (Date.now() - questionStartTime) / 1000;
            const correctIndex = questions[currentQuestion].correct;
            const buttons = optionsContainer.getElementsByTagName('button');

            // Disable all buttons and highlight correct/wrong
            for (let b of buttons) {
                b.disabled = true;
            }

            if (selectedIndex === correctIndex) {
                let bonus = 0;
                if (timeTaken < 10) {
                    bonus = Math.round(10 - timeTaken);
                    speedBonus += bonus;
                }
                score += 10;
                btn.classList.add('correct');
            } else {
                btn.classList.add('wrong');
                buttons[correctIndex].classList.add('correct');
            }

            updateScore();
            
            // Show Explanation alongside the question and options
            explanationText.innerText = questions[currentQuestion].exp;
            explanationBox.classList.remove('hidden');
            
            // Auto scroll to explanation for small screens
            setTimeout(() => {
                explanationBox.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
            }, 100);
        }

        function nextQuestion() {
            currentQuestion++;
            if (currentQuestion < questions.length) {
                showQuestion();
            } else {
                endGame();
            }
        }

        function updateScore() {
            scoreDisplay.innerText = score + speedBonus;
        }

        function endGame() {
            clearInterval(timerInterval);
            quizScreen.classList.add('hidden');
            resultScreen.classList.remove('hidden');
            
            const accuracy = Math.round((score / (questions.length * 10)) * 100);
            
            document.getElementById('final-score').innerText = score;
            document.getElementById('final-bonus').innerText = speedBonus;
            document.getElementById('final-accuracy').innerText = `${accuracy}%`;

            let title = "C·ªê G·∫ÆNG H∆†N N√â!";
            let icon = "üí™";
            let status = "ƒêa th·ª©c m·ªôt bi·∫øn c·∫ßn s·ª± c·∫©n th·∫≠n, h√£y luy·ªán t·∫≠p th√™m nh√©!";

            if (accuracy >= 90) {
                title = "HUY·ªÄN THO·∫†I MATH";
                icon = "üëë";
                status = "B·∫°n th·ª±c s·ª± l√† m·ªôt thi√™n t√†i v·ªÅ ƒêa th·ª©c! ƒê·ªô ch√≠nh x√°c g·∫ßn nh∆∞ tuy·ªát ƒë·ªëi.";
            } else if (accuracy >= 70) {
                title = "B·∫¨C TH·∫¶Y ƒêA TH·ª®C";
                icon = "üåü";
                status = "Ki·∫øn th·ª©c c·ªßa b·∫°n r·∫•t v·ªØng ch·∫Øc. Tuy·ªát v·ªùi!";
            } else if (accuracy >= 50) {
                title = "CHI·∫æN BINH MATH";
                icon = "‚öîÔ∏è";
                status = "B·∫°n ƒë√£ n·∫Øm ƒë∆∞·ª£c cƒÉn b·∫£n, h√£y ch√∫ √Ω h∆°n ·ªü c√°c c√¢u t√≠nh to√°n ph·ª©c t·∫°p.";
            }

            document.getElementById('result-title').innerText = title;
            document.getElementById('result-icon').innerHTML = `<span class="text-7xl">${icon}</span>`;
            document.getElementById('final-status').innerText = status;
        }

        function restartGame() {
            startGame();
        }
    </script>
</body>
</html>
